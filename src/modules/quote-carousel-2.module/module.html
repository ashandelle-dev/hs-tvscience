{% require_css %}

<style>
  {% scope_css %}
  .quote-carousel-2 {
    background-color: {{ module.styles.background_color.css }};
    color: {{ module.styles.text_color.css }};
    {{ module.styles.padding.css }}
    border: 1px solid {{module.styles.border_color.css}};
    {% if module.styles.max_width != 0 %}
    max-width: {{ module.styles.max_width }}px !important;
    margin: 0 auto;
    {% endif %}
    position: relative;
    overflow: hidden;
  }
  .quote-carousel-2 .content-body {
    {% if module.styles.font_size != 0 %}
    font-size: {{ module.styles.font_size }}px !important;
    line-height: 1.225 !important;
    {% endif %}
  }
  .quote-carousel-2__track {
    display: flex;
    transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .quote-carousel-2__slide {
    flex: 0 0 100%;
    min-width: 100%;
    opacity: 0;
    transition: opacity 0.5s ease;
    pointer-events: none;
  }
  .quote-carousel-2__slide.is-active {
    opacity: 1;
    pointer-events: auto;
  }
  .quote-carousel-2__logo {
    margin-bottom: 24px;
  }
  .quote-carousel-2__logo img {
    margin: 0;
  }
  .quote-carousel-2__dots {
    display: flex;
    gap: 10px;
    margin-top: 32px;
  }
  .quote-carousel-2__dot {
    width: 32px;
    height: 6px;
    border-radius: 3px;
    background-color: {{ module.styles.dot_inactive_color.css }};
    border: none;
    cursor: pointer;
    padding: 0;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }
  .quote-carousel-2__dot:hover {
    transform: scaleY(1.3);
  }
  .quote-carousel-2__dot.is-active {
    background-color: {{ module.styles.dot_active_color.css }};
  }
  {% end_scope_css %}
</style>

{% end_require_css %}

{% set custom_color = module.styles.text_color.css is truthy %}

{% if module.slides %}
<div {% if module.custom_id %}id="{{module.custom_id}}"{% endif %}
     class="quote-carousel-2 color-{{ custom_color }} flex flex-col relative rounded-2xl"
     data-autoplay="{{ module.autoplay }}"
     data-autoplay-speed="{{ module.autoplay_speed * 1000 }}">

  <div class="quote-carousel-2__track">
    {% for slide in module.slides %}
    <div class="quote-carousel-2__slide pl-4{% if loop.first %} is-active{% endif %}" data-slide-index="{{ loop.index0 }}">

      {% if slide.company_logo.src %}
      <div class="quote-carousel-2__logo">
        <img src="{{ slide.company_logo.src }}"
             alt="{{ slide.company_logo.alt }}"
             loading="{{ slide.company_logo.loading|default('lazy') }}"
             {% if slide.company_logo.width %}width="{{ slide.company_logo.width }}"{% endif %}
             {% if slide.company_logo.height %}height="{{ slide.company_logo.height }}"{% endif %}>
      </div>
      {% endif %}

      {# Quote at top #}
      <p class="content-body {% if module.styles.font_size == 0 %} heading-m {% endif %} mb-6 leading-tight" style="{% if slide.quote.quote_text_color.css %}color: {{slide.quote.quote_text_color.css}};{% endif %}">
        "{{ slide.quote.qs_quote }}"
      </p>

      {# Author info: headshot on left, name/title on right #}
      <div class="flex items-center gap-6">
        {% if slide.headshot.src %}
        <div class="content-image flex-shrink-0">
          {% set sizeAttrs = 'width="{{ slide.headshot.width }}" height="{{ slide.headshot.height }}"' %}
          {% if slide.headshot.size_type == 'auto' %}
            {% set sizeAttrs = 'width="{{ slide.headshot.width }}" height="{{ slide.headshot.height }}" style="max-width: 100%; height: auto;"' %}
          {% elif slide.headshot.size_type == 'auto_custom_max' %}
            {% set sizeAttrs = 'width="{{ slide.headshot.max_width }}" height="{{ slide.headshot.max_height }}" style="max-width: 100%; height: auto;"' %}
          {% endif %}
          {% set loadingAttr = slide.headshot.loading != 'disabled' ? 'loading="{{ slide.headshot.loading }}"' : '' %}
          <img class="{% if slide.round_headshot %} rounded-full {% endif %}" src="{{ slide.headshot.src }}" alt="{{ slide.headshot.alt }}" {{ loadingAttr }} {{ sizeAttrs }}>
        </div>
        {% endif %}
        <div class="border-l-2 {% if !custom_color %} border-[#71E09D] {% endif %} pl-6" {% if custom_color %}style="border-color: {{ module.styles.text_color.css }};"{% endif %}>
          {% if slide.quote_name.qs_name %}
          <p class="content-author font-bold font-rubik text-xl text-[#438663] m-0" style="{% if slide.quote_name.name_color.css %}color: {{slide.quote_name.name_color.css}};{% endif %}">
            {{ slide.quote_name.qs_name }}
          </p>
          {% endif %}
          {% if slide.title.qs_title %}
          <p class="content-title m-0 lg:text-lg text-sm text-[#438663] font-rubik" style="{% if slide.title.title_color.css %}color: {{slide.title.title_color.css}};{% endif %}">
            {{ slide.title.qs_title }}
          </p>
          {% endif %}
        </div>
      </div>

    </div>
    {% endfor %}
  </div>

  {% if module.slides|length > 1 %}
  <div class="quote-carousel-2__dots ml-4" role="tablist" aria-label="Carousel navigation">
    {% for slide in module.slides %}
    <button class="quote-carousel-2__dot{% if loop.first %} is-active{% endif %}"
            data-slide-target="{{ loop.index0 }}"
            role="tab"
            aria-selected="{{ loop.first }}"
            aria-label="Go to slide {{ loop.index }}"></button>
    {% endfor %}
  </div>
  {% endif %}

</div>
{% endif %}
