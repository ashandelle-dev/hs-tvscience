<!-- Partner Listing Module -->
{% set table = module.hubdb_table %}
{% set categories_filters = hubdb_table_column(table, "category") %}
{% set capabilities_filters = hubdb_table_column(table, "capability") %}
{% set partners = hubdb_table_rows(table, "orderBy=partner_name") %}

<div class="partner-listing-wrapper">
  <div class="partner-listing-container py-8 lg:py-12">
    <div class="flex flex-col lg:flex-row gap-8">

      <!-- Left Sidebar - Filters -->
      <aside class="partner-filters w-full lg:w-64 flex-shrink-0">

        <!-- Collections Filter -->
        <div class="filter-group mb-10">
          <h3 class="text-2xl font-bold mb-6 text-[#1F252B]">Filters</h3>
          <div class="filter-options flex flex-wrap gap-3">
            <button
              class="category-filter filter-button px-4 py-2 text-sm rounded-full border-2 border-[#D9E2EB] bg-white text-[#202223] cursor-pointer hover:border-[#10b981] hover:bg-[#10b981] hover:text-white transition-all"
              data-filter-type="all"
              data-filter-value="all"
            >
              All
            </button>
            {% for option in module.filters %}
            <button
              class="category-filter filter-button px-4 py-2 text-sm rounded-full border-2 border-[#D9E2EB] bg-white text-[#202223] cursor-pointer hover:border-[#10b981] hover:bg-[#10b981] hover:text-white transition-all"
              data-filter-type="{{ option.value }}"
              data-filter-value="{{ option.value }}"
            >
              {{ option.label_ }}
            </button>
            {% endfor %}
          </div>
        </div>
      </aside>

       <!-- Featured Integrations Section -->
       {% set featured_partners = [] %}
       {% set regular_partners = [] %}
       {% for partner in partners %}
         {% if partner.featured_ %}
           {% do featured_partners.append(partner) %}
         {% else %}
           {% do regular_partners.append(partner) %}
         {% endif %}
       {% endfor %}

      <!-- Right Content - Partner Cards Grid -->
      <main class="partner-grid-container flex-1 w-full">

        {% if featured_partners %}
        <div class="featured-section mb-12">
          <h2 class="text-2xl font-bold text-[#1F252B] mb-6">Featured Integrations</h2>
          <div class="partner-grid grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6">
            {% for partner in featured_partners %}
            <a
              href="{{ partner.partner_url }}"
              target="_blank"
              rel="noopener noreferrer"
              class="flex flex-col partner-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 lg:p-6 hover:shadow-md transition-shadow no-underline hover:no-underline hover:border-[#23E596] relative"
              data-categories="{% for cat in partner.category %}{{ cat.name }}{% if not loop.last %},{% endif %}{% endfor %}"
              data-capabilities="{% for cap in partner.capability %}{{ cap.name }}{% if not loop.last %},{% endif %}{% endfor %}"
              data-featured="true"
            >
              <!-- Featured Badge -->
              <span class="absolute top-4 right-4 bg-[#198960] text-white text-[10px] font-bold px-2 py-1 rounded uppercase">Featured</span>

              <!-- Partner Logo -->
              <div class="partner-logo mb-6">
                {% if partner.logo %}
                <img
                  src="{{ partner.logo.url }}"
                  alt="{{ partner.logo.altText or partner.partner_name }}"
                  width="{{ partner.logo.width }}"
                  height="{{ partner.logo.height }}"
                  class="inline-block"
                >
                {% else %}
                <div class="w-full h-full bg-gray-200 rounded"></div>
                {% endif %}
              </div>

              <!-- Partner Name -->
              <h3 class="partner-name text-base text-[#1F252B] font-bold mb-3">
                {{ partner.partner_name }}
              </h3>

              <!-- Partner Description -->
              <p class="partner-description text-gray-600 text-sm mb-4">
                {{ partner.description }}
              </p>

              <!-- Category Tags -->
              <div class="partner-tags flex flex-wrap gap-2">
                {% for category in partner.category %}
                <span class="category-tag p-1 text-[#1F252B] text-xs rounded border-[#D9E2EB] border">
                  {{ category.label }}
                </span>
                {% endfor %}
                {% for capability in partner.capability %}
                <span class="capability-tag p-1 text-[#1F252B] text-xs rounded border-[#D9E2EB] border">
                  {{ capability.label }}
                </span>
                {% endfor %}
              </div>

            </a>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        <!-- All Integrations Section -->
        <div class="all-integrations-section">
          <h2 class="text-2xl font-bold text-[#1F252B] mb-6">All Integrations</h2>
          <div class="partner-grid grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6">
            {% for partner in regular_partners %}
            <a
              href="{{ partner.partner_url }}"
              target="_blank"
              rel="noopener noreferrer"
              class="flex flex-col partner-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 lg:p-6 hover:shadow-md transition-shadow no-underline hover:no-underline hover:border-[#23E596]"
              data-categories="{% for cat in partner.category %}{{ cat.name }}{% if not loop.last %},{% endif %}{% endfor %}"
              data-capabilities="{% for cap in partner.capability %}{{ cap.name }}{% if not loop.last %},{% endif %}{% endfor %}"
              data-featured="false"
            >

              <!-- Partner Logo -->
              <div class="partner-logo mb-6">
                {% if partner.logo %}
                <img
                  src="{{ partner.logo.url }}"
                  alt="{{ partner.logo.altText or partner.partner_name }}"
                  width="{{ partner.logo.width }}"
                  height="{{ partner.logo.height }}"
                  class="inline-block"
                >
                {% else %}
                <div class="w-full h-full bg-gray-200 rounded"></div>
                {% endif %}
              </div>

              <!-- Partner Name -->
              <h3 class="partner-name text-base text-[#1F252B] font-bold mb-3">
                {{ partner.partner_name }}
              </h3>

              <!-- Partner Description -->
              <p class="partner-description text-gray-600 text-sm mb-4">
                {{ partner.description }}
              </p>

              <!-- Category Tags -->
              <div class="partner-tags flex flex-wrap gap-2">
                {% for category in partner.category %}
                <span class="category-tag p-1 text-[#1F252B] text-xs rounded border-[#D9E2EB] border">
                  {{ category.label }}
                </span>
                {% endfor %}
                {% for capability in partner.capability %}
                <span class="capability-tag p-1 text-[#1F252B] text-xs rounded border-[#D9E2EB] border">
                  {{ capability.label }}
                </span>
                {% endfor %}
              </div>

            </a>
            {% endfor %}
          </div>
        </div>

        <!-- No Results Message -->
        <div class="no-results hidden text-center py-12">
          <p class="text-gray-500 text-lg">No partners found matching your filters.</p>
        </div>
      </main>

    </div>
  </div>
</div>